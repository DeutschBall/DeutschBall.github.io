<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Cascadia Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"deutschball.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"万一找到了呢","hits_empty":"你说的 ${query} 我怎么找不着呢 ","hits_stats":"找到了 ${hits} 个结果，用时 ${time} 毫秒"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="【挑战20天学完多元统计分析，让我们说：DDL是最佳生产力！】 Ch1 多元分布 [TOC] 1.0 预备知识 1.0.1 随机变量\(X\) 随机变量\(X\)期望、矩、方差：        期望 \(E(X)&#x3D;\begin{cases}\int^{\infty}_{-\infty}tf(t)dt,\quad &amp;若X连续;\\\sum_ix_iP\{X&#x3D;x_">
<meta property="og:type" content="article">
<meta property="og:title" content="wtf">
<meta property="og:url" content="http://deutschball.github.io/2024/11/26/Ch1%20%E5%A4%9A%E5%85%83%E5%88%86%E5%B8%83/index.html">
<meta property="og:site_name" content="dustland">
<meta property="og:description" content="【挑战20天学完多元统计分析，让我们说：DDL是最佳生产力！】 Ch1 多元分布 [TOC] 1.0 预备知识 1.0.1 随机变量\(X\) 随机变量\(X\)期望、矩、方差：        期望 \(E(X)&#x3D;\begin{cases}\int^{\infty}_{-\infty}tf(t)dt,\quad &amp;若X连续;\\\sum_ix_iP\{X&#x3D;x_">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-11-26T13:17:00.000Z">
<meta property="article:modified_time" content="2024-12-01T13:00:47.341Z">
<meta property="article:author" content="dustball">
<meta property="article:tag" content="wtf">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://deutschball.github.io/2024/11/26/Ch1%20%E5%A4%9A%E5%85%83%E5%88%86%E5%B8%83/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>wtf | dustland</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">dustland</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">dustball in dustland</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/deutschball" class="github-corner" title="Follow me on GayHub" aria-label="Follow me on GayHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://deutschball.github.io/2024/11/26/Ch1%20%E5%A4%9A%E5%85%83%E5%88%86%E5%B8%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/DeutschBall/picbed/main/dustball.png">
      <meta itemprop="name" content="dustball">
      <meta itemprop="description" content="dustland">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dustland">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          wtf
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-11-26 21:17:00" itemprop="dateCreated datePublished" datetime="2024-11-26T21:17:00+08:00">2024-11-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-01 21:00:47" itemprop="dateModified" datetime="2024-12-01T21:00:47+08:00">2024-12-01</time>
              </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>【挑战20天学完多元统计分析，让我们说：DDL是最佳生产力！】</p>
<h1 id="ch1-多元分布">Ch1 多元分布</h1>
<p>[TOC]</p>
<h2 id="预备知识">1.0 预备知识</h2>
<h3 id="随机变量x">1.0.1 随机变量<span
class="math inline">\(X\)</span></h3>
<p>随机变量<span class="math inline">\(X\)</span>期望、矩、方差：</p>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 88%" />
</colgroup>
<thead>
<tr>
<th>期望</th>
<th><span
class="math inline">\(E(X)=\begin{cases}\int^{\infty}_{-\infty}tf(t)dt,\quad
&amp;若X连续;\\\sum_ix_iP\{X=x_i\},\quad
&amp;若X离散;\end{cases}\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>矩</strong></td>
<td><strong><span
class="math inline">\(E(X^k)\begin{cases}\int^{\infty}_{-\infty}t^kf(t)dt,\quad
&amp;若X连续;\\\sum_ix_i^kP\{X=x_i\},\quad
&amp;若X离散;\end{cases}\)</span></strong></td>
</tr>
<tr>
<td><strong>方差</strong></td>
<td><strong><span
class="math inline">\(Var(X)=E\left[(X-E(X))^2\right]=E(X^2)-(E(X))^2\)</span></strong></td>
</tr>
</tbody>
</table>
<h3 id="随机向量xx_1x_2dotsx_p">1.0.2 随机向量<span
class="math inline">\(X=(X_1,X_2,\dots,X_p)&#39;\)</span></h3>
<p>令<span
class="math inline">\(x=(x_1,x_2,\dots,x_p)&#39;\)</span>，<span
class="math inline">\(X_1,X_2,\dots,X_p\)</span>相互独立，当且仅当<span
class="math inline">\(F(x_1,x_2,\dots,x_p)=\prod^p_{i=1}F_i(x_i),\forall
x\in \mathbb{R}^p\)</span>，其中<span
class="math inline">\(F_i(x_i)\)</span>是<span
class="math inline">\(X_i\)</span>的边缘<strong>分布</strong>函数。</p>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr>
<th><strong>联合分布函数</strong></th>
<th><span
class="math inline">\(\begin{align}F(x_1,x_2\dots,x_p)&amp;=P\{X_1\le
x_1,X_2\le x_2,\dots,X_p\le x_p\}\\&amp;=P(X\le
x)\end{align}\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>联合概率密度函数(非负)</strong></td>
<td>存在<span
class="math inline">\(f(t_1,t_2,\dots,t_p)\)</span>满足下式：<span
class="math inline">\(F(x_1,x_2\dots,x_p)=\int^{x_1}_{-\infty}\int^{x_2}_{-\infty}\dots\int^{x_p}_{-\infty}f(t_1,t_2,\dots,t_p)dt_1dt_2\dots
d_p\)</span></td>
</tr>
<tr>
<td><strong>边缘分布</strong></td>
<td>(也就是选取随机向量中的部分、构成的分布)。<span
class="math inline">\(X\)</span>的<span
class="math inline">\(q\)</span>个分量(<span
class="math inline">\(q&lt;p\)</span>)<span
class="math inline">\(X^{(1)}=(X_1,X_2,\dots,X_q)&#39;\)</span>的分布称为边缘分布。<span
class="math inline">\(P\{X^{(1)}\le u\}=P\{X_1\le u_1,\dots,X_q\le
u_q\}=F(u_1,\dots,u_q,+\infty,\dots +\infty)\)</span></td>
</tr>
<tr>
<td><strong>边缘概率密度函数</strong></td>
<td>对<span class="math inline">\(X^{(1)}\)</span>: <span
class="math inline">\(g(u)=\int_{\mathbb{R}^{p-q}}f(u,v)dv\)</span></td>
</tr>
<tr>
<td><strong>条件密度</strong></td>
<td>令<span
class="math inline">\(X=(X^{(1)}{&#39;},X^{(2)}{&#39;})&#39;\)</span>,
<span class="math inline">\(f(x)=f(x^{(1)},x^{(2)})\)</span>。<span
class="math inline">\(X^{(2)}\)</span>在给定<span
class="math inline">\(X^{(1)}=x^{(1)}\)</span>的条件密度为：<span
class="math inline">\(f(x^{(2)}|X^{(1)}=x^{(1)})=\frac{f(x^{(1)},x^{(2)})}{g(x^{(1)})}\)</span>，<span
class="math inline">\(g(x^{(1)})\)</span>是<span
class="math inline">\(X^{(1)}\)</span>的边缘概率密度函数。</td>
</tr>
</tbody>
</table>
<h3 id="多元随机变量随机向量">1.0.3 多元随机变量(随机向量)</h3>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr>
<th>期望<span class="math inline">\(E(X)\)</span></th>
<th><span
class="math inline">\(E(X)=(E(X_1),E(X_2),\dots,E(X_p))&#39;\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>协方差<span
class="math inline">\(Cov(X)\)</span></strong></td>
<td><strong><span
class="math inline">\(Cov(X)=E\left[(X-E(X))(X-E(X))&#39;\right]\)</span></strong></td>
</tr>
<tr>
<td><strong>协方差<span
class="math inline">\(Cov(X,Y)\)</span></strong></td>
<td><strong><span
class="math inline">\(Cov(X,Y)=E\left[(X-E(X))(Y-E(Y))&#39;\right]\)</span></strong></td>
</tr>
</tbody>
</table>
<h3 id="矩阵知识">1.0.4 矩阵知识</h3>
<p>一些运算：</p>
<ul>
<li><p><span
class="math inline">\(E(tr(AXB))=tr(AE(X)B)\)</span>：期望和trace的计算等级相同。</p></li>
<li><p><span class="math inline">\(Cov(AX)=ACov(X)A&#39;\)</span></p>
<blockquote>
<p><span class="math display">\[
\begin{align}
Cov(AX)&amp;=E\left[(AX-E(AX))(AX-E(AX))&#39;\right]\\
&amp;=E\left[A(X-E(X))(X-E(X))&#39;A&#39;\right]\\
&amp;=AE\left[(X-E(X))(X-E(X))&#39;\right]A&#39;\\
&amp;=ACov(X)A&#39;
\end{align}
\]</span></p>
</blockquote></li>
<li><p><span
class="math inline">\(Cov(AX,BY)=ACov(X,Y)B&#39;\)</span></p></li>
<li><p><span
class="math inline">\(E(X&#39;AX)=(E(X))&#39;A(E(X))+tr(ACov(X))\)</span>：二次型，此公式将期望值分解为常数项（期望向量的二次型）和随机项（协方差矩阵与
A 的迹）。</p>
<blockquote>
<p><span class="math display">\[
\begin{align}
E(X&#39;AX)&amp;=E(\sum_{i,j}X_iA_{ij}X_j)\\
&amp;=\sum_{i,j}A_{ij}E(X_iX_j)\\
&amp;=\sum_{i,j}A_{ij}(E(X_i)E(X_j)+Cov(X_i,X_j)\\
&amp;=(E(X))&#39;A(E(X))+tr(ACov(X))
\end{align}
\]</span></p>
</blockquote></li>
</ul>
<p>分块矩阵：</p>
<p><span
class="math inline">\(A=\begin{pmatrix}A_{11}&amp;A_{12}\\A_{21}&amp;A_{22}\end{pmatrix}\)</span>，其中<span
class="math inline">\(A_{11}\)</span>是非退化的方阵(可逆，满秩)。</p>
<p>记<span
class="math inline">\(A_{2|1}=A_{22}-A_{21}A_{11}^{-1}A_{12}\)</span>，则有<span
class="math inline">\(|A|=|A_{11}|·|A_{2|1}|\)</span>。 <span
class="math display">\[
A^{-1}=\begin{pmatrix}
I&amp;A_{11}^{-1}A_{12}\\
0&amp; I
\end{pmatrix}\begin{pmatrix}
A_{11}^{-1}&amp;0\\
0&amp;A_{2|1}^{-1}
\end{pmatrix}\begin{pmatrix}
I&amp;0\\
-A_{21}A_{11}^{-1}&amp;I
\end{pmatrix}
\]</span></p>
<p>记<span
class="math inline">\(A^{-1}=\begin{pmatrix}B_{11}&amp;B_{12}\\B_{21}&amp;B_{22}\end{pmatrix}\)</span>,
则有：</p>
<ul>
<li><span
class="math inline">\(B_{11}=(A_{11}-A_{12}A_{22}^{-1}A_{21})^{-1}\)</span></li>
<li><span
class="math inline">\(B_{22}=(A_{22}-A_{21}A_{11}^{-1}A_{12})^{-1}\)</span></li>
<li><span
class="math inline">\(B_{12}=-A_{11}^{-1}A_{12}(A_{22}-A_{21}A_{11}^{-1}A_{12})^{-1}\)</span></li>
<li><span
class="math inline">\(B_{21}=-(A_{22}-A_{21}A_{11}^{-1}A_{12})^{-1}A_{21}A_{11}^{-1}\)</span></li>
</ul>
<figure>
<img
src="https://cdn.jsdelivr.net/gh/SchwertLin/Pic/img/image-20241128173119356.png"
alt="image-20241128173119356" />
<figcaption aria-hidden="true">image-20241128173119356</figcaption>
</figure>
<h3 id="多元特征函数">1.0.5 多元特征函数</h3>
<p>(<strong>特征函数与概率分布函数一一对应</strong>)随机向量<span
class="math inline">\(X=(X_1,\dots,X_p)&#39;\)</span>的特征函数为：
<span class="math display">\[
\phi(t)=\phi(t_1,\dots,t_p)=E[e^{i(t_1X_1+\dots+t_pX_p)}]=E[e^{it&#39;X}]
\]</span> 其中, <span
class="math inline">\(t=(t_1,\dots,t_p)&#39;\in\mathbb{R}^p\)</span>,
<span class="math inline">\(i\)</span>是虚数单位(<span
class="math inline">\(i^2=-1\)</span>)</p>
<p>性质：</p>
<ol type="1">
<li>对正整数<span class="math inline">\(k_1,\dots,k_p\)</span>,
如果<span class="math inline">\(E(X_1^{k_1}\dots
X_p^{k_p})\)</span>存在, 则</li>
<li>对<span class="math inline">\(0&lt;k&lt;p\)</span>, 分量<span
class="math inline">\(X^{(1)}=(X_1,\dots,X_k)&#39;\)</span>的特征函数是<span
class="math inline">\(\phi(t_1,\dots,t_k,0,\dots,0)\)</span>.</li>
<li>记<span
class="math inline">\(X_1,\dots,X_p\)</span>的边缘特征函数分别为<span
class="math inline">\(\phi_1(t_1),\dots,\phi_p(t_p)\)</span>, 记<span
class="math inline">\(X=(X_1,\dots,X_p)&#39;\)</span>的特征函数是<span
class="math inline">\(\phi(t_1,\dots,t_p)\)</span>, 则<span
class="math inline">\(X_1,\dots,X_p\)</span>相互独立的充分必要条件是：<span
class="math inline">\(\phi(t_1,\dots,t_p)=\phi_1(t_1)\dots\phi_p(t_p)\)</span>.</li>
<li>设<span class="math inline">\(p\)</span>维随机向量<span
class="math inline">\(Y_1,\dots,Y_m\)</span>的特征函数分别为<span
class="math inline">\(\phi^{(1)}(t),\dots,\phi^{(m)}(t)\)</span>,
如果<span class="math inline">\(Y_1,\dots,Y_m\)</span>相互独立,
则随机向量和 <span
class="math inline">\(Y_1+\dots+Y_m\)</span>的特征函数为: <span
class="math inline">\(\phi(y)=\phi^{(1)}(t)\dots\phi^{(m)}(t)\)</span>.</li>
</ol>
<blockquote>
<p>Q:
==我个人感觉这个地方是不是写错了？Y怎么会是p维向量？那角标不应该是p吗？==</p>
<p>A: 在这里，<span class="math inline">\(Y_1, \dots, Y_m\)</span>
是独立的随机向量，每个 <span class="math inline">\(Y_i\)</span> 依然是
<span class="math inline">\(p\)</span> 维的，所以 <span
class="math inline">\(Y_1, \dots, Y_m\)</span> 是多个 <span
class="math inline">\(p\)</span> 维向量</p>
</blockquote>
<h2 id="一元正态分布">1.1 一元正态分布</h2>
<p>【分布密度】若随机变量<span
class="math inline">\(X\)</span>的概率密度函数为： <span
class="math display">\[
p(x)=\frac{1}{\sqrt{2\pi}\sigma}\exp\left\{-\frac{(x-\mu)^2}{2\sigma^2}\right\}
\]</span> 其中<span
class="math inline">\(-\infty&lt;x,\mu&lt;\infty,\sigma^2&gt;0\)</span>，则称随机变量X服从正态分布。记为<span
class="math inline">\(X\overset{d}{\sim}N(\mu,\sigma^2)\)</span>,
其中<span class="math inline">\(\mu\)</span>是均值, <span
class="math inline">\(\sigma^2\)</span>是方差。</p>
<h2 id="多元正态分布">1.2 多元正态分布</h2>
<p>【分布密度】若<span class="math inline">\(p\)</span>元随机向量<span
class="math inline">\(X\)</span>服从参数为<span
class="math inline">\(\mu,\Sigma\)</span>的多元正态分布，其概率密度函数为：</p>
<p><span class="math display">\[
p(x)=(2\pi)^{-\frac p 2}|\Sigma|^{-\frac 1 2}\exp\left\{-\frac 1 2
(x-\mu)&#39;\Sigma^{-1}(x-\mu)\right\}
\]</span></p>
<p><span class="math display">\[
p(x)=(2\pi)^{-\frac p 2}|\Sigma|^{-\frac 1 2}\exp\{-\frac 1 2
(x-\mu)&#39;\Sigma^{-1}(x-\mu)\}
\]</span> 其中<span
class="math inline">\(\mu\in\mathbb{R}^p\)</span>，<span
class="math inline">\(\Sigma\)</span>为p阶正定矩阵，记为<span
class="math inline">\(X\overset{d}{\sim}N_p(\mu,\Sigma)\)</span>。</p>
<blockquote>
<p>d 代表服从分布(distribution)，<span
class="math inline">\(\Sigma\)</span>是多元正态分布的<strong>方差</strong>。</p>
</blockquote>
<p><strong>p元标准正态分布：</strong><span
class="math inline">\(X\overset{d}{\sim}N_p(0,I_p)\)</span></p>
<p><strong>定理1：</strong>设p元随机向量<span
class="math inline">\(X=\mu+AY\)</span>, 其中<span
class="math inline">\(\mu\in\mathbb{R}^k, A\)</span>为<span
class="math inline">\(k\times p\)</span>的行满秩矩阵，<span
class="math inline">\(k\le p\)</span>, 随机向量<span
class="math inline">\(Y\overset{d}{\sim}N_p(0,I_p)\)</span>, 则<span
class="math inline">\(X\overset{d}{\sim}N_k(\mu,\Sigma)\)</span>,
其中<span class="math inline">\(\Sigma=AA&#39;&gt;0\)</span>.</p>
<blockquote>
<p><strong>证明</strong>：随机向量 <span
class="math inline">\(X\)</span>的特征函数定义为： <span
class="math display">\[
\phi_X(t) = \mathbb{E} \left[ e^{i t^T X} \right]
\]</span> 其中，<span class="math inline">\(t
\in\mathbb{R}^k\)</span>是与 $X $同维度的向量。</p>
<p>代入 <span class="math inline">\(X = \mu +
AY\)</span>到特征函数的定义中，得到： <span class="math display">\[
\phi_X(t) = \mathbb{E} \left[ e^{i t^T (\mu + A Y)} \right]= e^{i t^T
\mu} \mathbb{E} \left[ e^{i t^T A Y} \right]
\]</span> 由于 $Y $是 <span
class="math inline">\(p\)</span>维标准正态随机向量，$Y N_p(0, I_p) <span
class="math inline">\(，其特征函数为：\)</span>$ _Y(t) = = e^{- t^T t}
$$ 这里 <span class="math inline">\(t\in \mathbb{R}^p\)</span>是与 $Y
$同维度的向量。</p>
<p><span class="math display">\[
\phi_X(t) = e^{i t^T \mu}\mathbb{E} \left[ e^{i t^T A Y} \right]= e^{i
t^T \mu}e^{-\frac{1}{2} (A^T t)^T (A^T t)}\\
=e^{i t^T \mu}e^{-\frac{1}{2} t^T A A^T t}
\]</span> 我们知道，一个 <span
class="math inline">\(k\)</span>维正态分布 $N_k(,) <span
class="math inline">\(的特征函数为：\)</span>$ (t) = e^{i t^T } e^{- t^T
t}=e^{i t^T }e^{- t^T A A^T t} $$</p>
<p>因此，$X $服从 <span class="math inline">\(N_k(\mu,
\Sigma)\)</span>分布，即： <span class="math display">\[
X \overset{d}{\sim} N_k(\mu, \Sigma)
\]</span></p>
<p>如何产生<span
class="math inline">\(N_p(\mu,\Sigma)\)</span>的(伪)随机数？--==Cholesky
分解==</p>
<p>生成的标准正态分布随机向量 <span
class="math inline">\(Z\overset{d}{\sim}N_p(0,I_p)\)</span>可以通过下列变换得到目标分布<span
class="math inline">\(X = \mu + L Z, \Sigma=LL&#39;\)</span>, L 是
Cholesky 分解得到的下三角矩阵，Z是标准正态随机向量。</p>
</blockquote>
<h3 id="性质">1.2.2 性质</h3>
<table>
<colgroup>
<col style="width: 22%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr>
<th>性质</th>
<th>说明: <span
class="math inline">\(X\overset{d}{\sim}N(\mu,\Sigma)\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>1.密度函数</td>
<td><span class="math inline">\(p(x)=(2\pi)^{-\frac p
2}\|\Sigma\|^{-\frac 1 2}\exp\left\{-\frac 1 2
(x-\mu)&#39;\Sigma^{-1}(x-\mu)\right\}\)</span></td>
</tr>
<tr>
<td>2.特征函数</td>
<td><span
class="math inline">\(E(\exp(it&#39;X))=\exp\{it&#39;\mu-\frac{t&#39;\Sigma
t}2\}\)</span></td>
</tr>
<tr>
<td>3.期望方差</td>
<td><span class="math inline">\(E(X)=\mu,Cov(X)=\Sigma\)</span></td>
</tr>
<tr>
<td>4.线性变换</td>
<td><span class="math inline">\(Y=\eta+AX,\eta\in\mathbb{R}^k,A_{k\times
p}, Y\overset{d}{\sim}N_k(\eta+A\mu,A\Sigma A&#39;)\)</span></td>
</tr>
<tr>
<td>5.相互独立</td>
<td>设<span class="math inline">\(X_1,\dots,X_k\)</span>相互独立，<span
class="math inline">\(X_i\overset{d}{\sim}N_p(\mu_i,\Sigma_i),1\le i\le
k\)</span>, 则<span
class="math inline">\(\sum^k_{i=1}\alpha_iX_i\overset{d}{\sim}N_p(\sum^k_{i=1}\alpha_i\mu_i,\sum^k_{i=1}\alpha^2_i\Sigma_i)\)</span></td>
</tr>
<tr>
<td>6.卡方分布</td>
<td><strong><span class="math inline">\(\Sigma&gt;0\)</span></strong>,
则<span
class="math inline">\((X-\mu)&#39;\Sigma^{-1}(X-\mu)\overset{d}{\sim}\chi^2_p\)</span>,
其中<span
class="math inline">\(\chi^2_p\)</span>是自由度为p的卡方分布。</td>
</tr>
<tr>
<td>7.矩阵分解</td>
<td><span
class="math inline">\(X=\begin{pmatrix}X_1^{(q)}\\X_2^{(p-q)}\end{pmatrix},\mu=\begin{pmatrix}\mu_1\\\mu_2\end{pmatrix},\Sigma=\begin{pmatrix}\Sigma_{11}&amp;\Sigma_{12}\\\Sigma_{21}&amp;\Sigma_{22}\end{pmatrix}\)</span>,则<span
class="math inline">\(X_1^{(q)}\overset{d}{\sim}N_q(\mu_1,\Sigma_{11}),X_2^{(p-q)}overset{d}{\sim}N_{p-q}(\mu_2,\Sigma_{22})\)</span></td>
</tr>
<tr>
<td>8.分量独立性</td>
<td><span class="math inline">\(X=\begin{pmatrix}
X_1^{(q_1)}\\\vdots\\X_k^{(q_k)}\end{pmatrix},\Sigma=\begin{pmatrix}\Sigma_{11}&amp;\ldots&amp;\Sigma_{1k}\\\vdots&amp;\ddots&amp;\vdots\\
\Sigma_{k1}&amp;\ldots&amp;\Sigma_{kk}\end{pmatrix}\)</span>,则<span
class="math inline">\(X_i^{(q_i)},X_j^{(q_j)}(1\le i&lt;j\le
k)\)</span>相互独立的<strong>充要条件</strong>是<span
class="math inline">\(Cov(X_i^{q_i},X_j^{(q_j)})=\Sigma_{ij}=0\)</span>.</td>
</tr>
<tr>
<td>9.条件分布</td>
<td><span
class="math inline">\((X_1|X_2=x_2)\overset{d}{\sim}N_q(\mu_{1|2},\Sigma_{1|2})\)</span>,其中<span
class="math inline">\(\mu_{1|2}=E(X_1|X_2=x_2)=\mu_1+\Sigma_{12}\Sigma_{22}^{-1}(x_2-\mu_2)\)</span>,<span
class="math inline">\(\Sigma_{1|2}=Cov(X_1|X_2=x_2)=\Sigma_{11}-\Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21}\)</span>.<span
class="math inline">\((\Sigma_{1|2}\le\Sigma_{11})\)</span></td>
</tr>
<tr>
<td>10.变量的独立分解</td>
<td>令<span
class="math inline">\(Y_1=X_1,Y_2=X_2-\Sigma_{21}\Sigma_{11}^{-1}X_1\)</span>;<span
class="math inline">\(Z_2=X_2,Z_1=X_1-\Sigma_{12}\Sigma_{22}^{-1}X_2\)</span>;则<span
class="math inline">\(Y_1\)</span>与<span
class="math inline">\(Y_2\)</span>相互独立，<span
class="math inline">\(Z_1\)</span>与<span
class="math inline">\(Z_2\)</span>相互独立，且<span
class="math inline">\(Y_1\overset{d}{\sim}N_q(\mu_1,\Sigma_{11}),Y_2\overset{d}{\sim}N_{p-q}(\mu_2-\Sigma_{21}\Sigma_{11}^{-1}\mu_1,\Sigma_{2|1})\)</span>,
<span
class="math inline">\(Z_2\overset{d}{\sim}N_{p-q}(\mu_2,\Sigma_{22}),Z_1\overset{d}{\sim}N_q(\mu_1-\Sigma_{12}\Sigma_{22}^{-1}\mu_2,\Sigma_{1\|2}\)</span>,<span
class="math inline">\((\Sigma_{2|1}=\Sigma_{22}-\Sigma_{21}\Sigma_{11}^{-1}\Sigma_{12})\)</span></td>
</tr>
</tbody>
</table>
<h2 id="相关系数">1.3 相关系数</h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 66%" />
</colgroup>
<thead>
<tr>
<th>定义</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>相关系数<span class="math inline">\(p_{ij}\)</span></td>
<td><span class="math inline">\(X_i\)</span>与<span
class="math inline">\(X_j\)</span>：<span
class="math inline">\(p_{ij}=\frac{Cov(X_i,X_j)}{\sqrt{Var(X_i)}\sqrt{Var(X_j)}}=\frac{\sigma_{ij}}{\sqrt{\sigma_{ii}}\sqrt{\sigma_{jj}}}\)</span></td>
</tr>
<tr>
<td>相关矩阵R</td>
<td><span
class="math inline">\(R=\begin{pmatrix}\rho_{11}&amp;\ldots&amp;\rho_{1p}\\\vdots
&amp;&amp;\vdots\\
\rho_{p1}&amp;\ldots&amp;\rho_{pp}\end{pmatrix}=diag(\sigma_{11}^{-\frac
1 2},\dots,\sigma_{pp}^{-\frac 1
2})\begin{pmatrix}\sigma_{11}&amp;\ldots&amp;\sigma_{1p}\\\vdots
&amp;&amp;\vdots\\
\sigma_{p1}&amp;\ldots&amp;\sigma_{pp}\end{pmatrix}diag(\sigma_{11}^{-\frac
1 2},\dots,\sigma_{pp}^{-\frac 1 2})\)</span></td>
</tr>
<tr>
<td>偏相关系数</td>
<td><span
class="math inline">\(X=\begin{pmatrix}X_1^{(q)}\\X_2^{(p-q)}\end{pmatrix},\mu=\begin{pmatrix}\mu_1\\\mu_2\end{pmatrix},\Sigma=\begin{pmatrix}\Sigma_{11}&amp;\Sigma_{12}\\\Sigma_{21}&amp;\Sigma_{22}\end{pmatrix}\)</span>,
则<span
class="math inline">\((X_1^{(q)}\|X_2^{(p-q)})\overset{d}{\sim}N_q(\mu_{1|2},\Sigma_{1|2})\)</span>.
在给定<span class="math inline">\(X_2^{(p-q)}\)</span>的条件下，<span
class="math inline">\(X_i\)</span>与<span
class="math inline">\(X_j\)</span>的条件相关系数<span
class="math inline">\(\rho_{(ij)|(1|2)}=\frac{\sigma_{(ij)|(1|2)}}{\sqrt{\sigma_{(ii)|(1|2)}}\sqrt{\sigma_{(jj)|(1|2)}}}\)</span></td>
</tr>
<tr>
<td>精度矩阵<span class="math inline">\((k_{ij})_{p\times
p}\)</span></td>
<td>设随机向量<span class="math inline">\(X\)</span>，有<span
class="math inline">\(Cov(X)=\Sigma&gt;0\)</span>, 那么称<span
class="math inline">\(K=\Sigma^{-1}\)</span>为<span
class="math inline">\(X\)</span>的精度矩阵。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>偏相关系数是图模型和因果推断中的重要统计量，可以由特征函数+期望+方差，可以通过<strong>偏相关系数判别多元正态随机向量分量之间的条件独立性</strong>。</p>
</blockquote>
<p><strong>精度矩阵的性质：</strong></p>
<ol type="1">
<li><p>若<span
class="math inline">\(X=(X_1,\dots,X_p)&#39;\overset{d}{\sim}N_p(\mu,\Sigma),\Sigma&gt;0,K=\Sigma^{-1}=(k_{ij})_{p\times
p}\)</span>, 则<span
class="math inline">\(k_{ii}=(Var(X_i|X_{(-i)}))^{-1},1\le i\le
p\)</span>, 其中<span
class="math inline">\(X_{(-i)}=(X_1,\dots,X_{i-1},X_{(i+1)},\dots,X_p)&#39;,1\le
i\le p\)</span>, 设<span
class="math inline">\(X\overset{d}{\sim}N_p(\mu,\Sigma),\Sigma&gt;0\)</span>,
有如下分解：</p>
<p><span
class="math inline">\(X\begin{pmatrix}X_1^{(p_1)}\\X_2^{(p_2)}\\X_3^{(p_3)}\end{pmatrix},\Sigma=\begin{pmatrix}\Sigma_{11}&amp;\Sigma_{12}&amp;\Sigma_{13}\\\Sigma_{21}&amp;\Sigma_{22}&amp;\Sigma_{23}\\\Sigma_{31}&amp;\Sigma_{32}&amp;\Sigma_{33}\end{pmatrix},K=\begin{pmatrix}K_{11}&amp;K_{12}&amp;K_{13}\\K_{21}&amp;K_{22}&amp;K_{23}\\K_{31}&amp;K_{32}&amp;K_{33}\end{pmatrix}\)</span></p></li>
<li><p>在<span class="math inline">\(X_3\)</span>给定的条件下，<span
class="math inline">\(X_1\)</span>与<span
class="math inline">\(X_2\)</span>相互条件独立的充要条件是<span
class="math inline">\(K_{12}=0\)</span>(<span
class="math inline">\(K_{12}\)</span>是精度矩阵 <span
class="math inline">\(K\)</span>
中的元素，表示在给定其他所有变量的条件下，<span
class="math inline">\(X_1\)</span> 和<span
class="math inline">\(X_2\)</span> 的关系的强度。)</p>
<blockquote>
<p>证明： <span class="math display">\[
\begin{align}
\Sigma_{12|3}&amp;\overset{\text{定义}}{=}Cov((X_1,X_2)|X_3)\\
&amp;\overset{\text{性质9}}{=}\begin{pmatrix}\Sigma_{11}&amp;
\Sigma_{12}\\\Sigma_{21}&amp;\Sigma_{22}\end{pmatrix}-\begin{pmatrix}\Sigma_{13}\\\Sigma_{23}\end{pmatrix}\Sigma_{33}^{-1}\begin{pmatrix}\Sigma_{31}&amp;
\Sigma_{32}\end{pmatrix}\\
&amp;\overset{\text{矩阵运算}}{=}\begin{pmatrix}\Sigma_{11}-\Sigma_{13}\Sigma_{33}^{-1}\Sigma_{31}&amp;\Sigma_{12}-\Sigma_{13}\Sigma_{33}^{-1}\Sigma_{32}\\\Sigma_{21}-\Sigma_{23}\Sigma_{33}^{-1}\Sigma_{31}&amp;\Sigma_{22}-\Sigma_{23}\Sigma_{33}^{-1}\Sigma_{32}\end{pmatrix}\\
&amp;\overset{\text{分块矩阵运算}}{=}\begin{pmatrix}K_{11}&amp;K_{12}\\K_{21}&amp;K_{22}\end{pmatrix}^{-1}
\end{align}
\]</span> 由(分量独立性)：<span class="math inline">\(X=\begin{pmatrix}
X_1^{(q_1)}\\\vdots\\X_k^{(q_k)}\end{pmatrix},\Sigma=\begin{pmatrix}\Sigma_{11}&amp;\ldots&amp;\Sigma_{1k}\\\vdots&amp;\ddots&amp;\vdots\\
\Sigma_{k1}&amp;\ldots&amp;\Sigma_{kk}\end{pmatrix}\)</span>, 则<span
class="math inline">\(X_i^{(q_i)},X_j^{(q_j)}(1\le i&lt;j\le
k)\)</span>相互独立的<strong>充要条件</strong>是<span
class="math inline">\(Cov(X_i^{q_i},X_j^{(q_j)})=\Sigma_{ij}=0\)</span>.</p>
<p>则<span class="math inline">\(X_1\)</span>与<span
class="math inline">\(X_2\)</span>条件独立的充要条件为<span
class="math inline">\(\Sigma_{12}-\Sigma_{13}\Sigma_{33}^{-1}\Sigma_{32}=0\)</span>,<span
class="math inline">\(K_{12}=0\)</span>;则推广有<span
class="math inline">\(K_{13}=0,K_{23}=0\)</span>.</p>
<p>无量纲：<strong>因为精度矩阵的数值与变量的量纲有关</strong>，所以进行标准化处理。令<span
class="math inline">\(C=\begin{pmatrix}c_{11}&amp;\ldots&amp;c_{1p}\\\vdots
&amp;\ddots&amp;\vdots\\
c_{p1}&amp;\ldots&amp;c_{pp}\end{pmatrix}\overset{\Delta}{=}diag(k_{11}^{-\frac
1 2},\dots,k_{pp}^{-\frac 1
2})\begin{pmatrix}k_{11}&amp;\ldots&amp;k_{1p}\\\vdots
&amp;\ddots&amp;\vdots\\
k_{p1}&amp;\ldots&amp;k_{pp}\end{pmatrix}diag(k_{11}^{-\frac 1
2},\dots,k_{pp}^{-\frac 1 2})\)</span></p>
<p><span
class="math inline">\(C=\begin{pmatrix}C_{11}&amp;C_{12}&amp;C_{13}\\C_{21}&amp;C_{22}&amp;C_{23}\\
C_{31}&amp;C_{32}&amp;C_{33}\end{pmatrix}\)</span>,(将得到的C根据<span
class="math inline">\(X_1,X_2,X_3\)</span>分块)。</p>
<p>在给定<span class="math inline">\(X_3\)</span>的条件下，<span
class="math inline">\(X_1\)</span>与<span
class="math inline">\(X_2\)</span>条件独立的充要条件<span
class="math inline">\(C_{12}=0\)</span>.</p>
</blockquote></li>
</ol>
<h3 id="练习">1.3.1 练习</h3>
<figure>
<img
src="https://cdn.jsdelivr.net/gh/SchwertLin/Pic/img/image-20241201094117103.png"
alt="image-20241201094117103" />
<figcaption aria-hidden="true">image-20241201094117103</figcaption>
</figure>
<figure>
<img
src="https://cdn.jsdelivr.net/gh/SchwertLin/Pic/img/image-20241201094132212.png"
alt="image-20241201094132212" />
<figcaption aria-hidden="true">image-20241201094132212</figcaption>
</figure>
<p>对于<span
class="math inline">\(\hat{E}(Y|X_1,X_2,X_3,X_4)=\mu_Y+\Sigma_{YX}\Sigma_{XX}^{-1}(X-\mu_X)\)</span>：
<span class="math display">\[
\begin{align}
\hat{E}(Y|X)&amp;=\mu_Y+\Sigma_{YX}\Sigma_{XX}^{-1}(X-\mu_X)\\
&amp;=95.423+\begin{pmatrix}56.689&amp;176.381&amp;-47.556&amp;-190.9\end{pmatrix}\begin{pmatrix}31.941&amp;
19.314&amp; -28.663&amp;-22.308\\
              19.314&amp; 223.515&amp; -12.811&amp;-233.923\\
              -28.663&amp; -12.811&amp; 37.87&amp;2.923\\
              -22.308&amp; -233.923&amp; 2.923&amp;
258.615\end{pmatrix}^{-1}\begin{pmatrix}X_1-7.462\\X_2-48.154\\X_3-11.769\\X_4-30\end{pmatrix}\\
&amp;=95.423+\begin{pmatrix}-2.06871&amp; -2.83557 &amp;-3.51512&amp;
-3.44172\end{pmatrix}\begin{pmatrix}X_1-7.462\\X_2-48.154\\X_3-11.769\\X_4-30\end{pmatrix}\\
&amp;=95.423-2.069(X_1-7.462)-2.836(X_2-48.154)-3.515(X_3-11.769)-3.442(X_4-30)
\end{align}
\]</span> <img
src="https://cdn.jsdelivr.net/gh/SchwertLin/Pic/img/image-20241201095141147.png"
alt="image-20241201095141147" /></p>
<p>预测：计算y关于<span
class="math inline">\((x_1,x_2)\)</span>的条件期望，从而用<span
class="math inline">\((x_1,x_2)\)</span>预测<span
class="math inline">\(y\)</span>:</p>
<figure>
<img
src="https://cdn.jsdelivr.net/gh/SchwertLin/Pic/img/image-20241201101835469.png"
alt="image-20241201101835469" />
<figcaption aria-hidden="true">image-20241201101835469</figcaption>
</figure>
<h2 id="矩阵多元正态分布">1.4 矩阵多元正态分布</h2>
<h3 id="矩阵拉直和kronecker积">1.4.0 矩阵拉直和Kronecker积</h3>
<p><strong>矩阵拉直</strong>：记<span
class="math inline">\(X=(x_1,\dots,x_p)是\)</span><span
class="math inline">\(n\times
p\)</span>的矩阵。矩阵拉直运算，是将矩阵按<strong>列</strong>拉直为向量<span
class="math inline">\(vec(X)=\begin{pmatrix}x_1\\\vdots\\x_p\end{pmatrix}_{np\times
1}\)</span></p>
<p><strong>Kronecker积</strong>：令<span
class="math inline">\(A=(a_{ij})_{n\times p},B_{m\times
q}\)</span>，A和B的Kronecker积记为：<span class="math inline">\(A\otimes
B=(a_{ij}B)_{nm\times pq}\)</span></p>
<blockquote>
<p>令<span class="math inline">\(X=\begin{pmatrix} 1 &amp; 2 \\ 3 &amp;
4 \\ 5 &amp; 6 \end{pmatrix},vec(X)=\begin{pmatrix} 1 \\ 3 \\ 5 \\ 2 \\
4 \\ 6 \end{pmatrix}\)</span></p>
<p>令<span class="math inline">\(A = \begin{pmatrix} 1 &amp; 2 \\ 3
&amp; 4 \end{pmatrix}, \quad B = \begin{pmatrix} 0 &amp; 5 \\ 6 &amp; 7
\end{pmatrix}\)</span></p>
<p><span class="math inline">\(A \otimes B\)</span> 的计算步骤如下：</p>
$ A B =
<span class="math display">\[\begin{pmatrix}
0 &amp; 5 &amp; \vert &amp; 0 &amp; 10 \\
6 &amp; 7 &amp; \vert &amp; 12 &amp; 14 \\
\hline
0 &amp; 15 &amp; \vert &amp; 0 &amp; 20 \\
18 &amp; 21 &amp; \vert &amp; 24 &amp; 28
\end{pmatrix}\]</span>
<p>$</p>
</blockquote>
<p><strong>拉直运算和Kronecker积的性质</strong></p>
<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 93%" />
</colgroup>
<thead>
<tr>
<th>性质</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>对任意实数<span class="math inline">\(\lambda\)</span>，有<span
class="math inline">\((\lambda A)\otimes B = A\otimes(\lambda
B)=\lambda(A\otimes B)\)</span></td>
</tr>
<tr>
<td>2</td>
<td><span class="math inline">\(A\otimes(B + C)=A\otimes B+A\otimes
C\)</span>，<span class="math inline">\((B + C)\otimes A = B\otimes
A+C\otimes A\)</span></td>
</tr>
<tr>
<td>3</td>
<td><span class="math inline">\((A\otimes B)\otimes C =
A\otimes(B\otimes C)\)</span></td>
</tr>
<tr>
<td>4</td>
<td><span class="math inline">\((A\otimes B)&#39;=A&#39;\otimes
B&#39;\)</span></td>
</tr>
<tr>
<td>5</td>
<td><span class="math inline">\((A\otimes B)(C\otimes
D)=(AC)\otimes(BD)\)</span></td>
</tr>
<tr>
<td>6</td>
<td>若<span class="math inline">\(A\)</span>和<span
class="math inline">\(B\)</span>都是非奇异的方阵，则<span
class="math inline">\((A\otimes B)^{-1}=A^{-1}\otimes
B^{-1}\)</span></td>
</tr>
<tr>
<td>7</td>
<td><span class="math inline">\(\text{tr}(A\otimes
B)=\text{tr}(A)\cdot\text{tr}(B)\)</span>，<span
class="math inline">\(\text{tr}(C&#39;D)=({vec}(C))&#39;({vec}(D))\)</span></td>
</tr>
<tr>
<td>8</td>
<td>若<span class="math inline">\(A\)</span>和<span
class="math inline">\(B\)</span>分别是<span
class="math inline">\(n\)</span>和<span
class="math inline">\(m\)</span>阶方阵，则<span
class="math inline">\(\vert A\otimes B\vert=\vert A\vert^{n}\cdot\vert
B\vert^{m}\)</span></td>
</tr>
<tr>
<td>9</td>
<td>若<span class="math inline">\(A\)</span>、<span
class="math inline">\(Y\)</span>和<span
class="math inline">\(B\)</span>分别是<span
class="math inline">\(n\times p\)</span>、<span
class="math inline">\(p\times q\)</span>和<span
class="math inline">\(q\times m\)</span>的矩阵，则<span
class="math inline">\({vec}(AYB)=(B&#39;\otimes
A){vec}(Y)\)</span>。(如果我们对矩阵 <span
class="math inline">\(Y\)</span> 进行线性变换 <span
class="math inline">\(AYB\)</span>，那么其 <strong>“拉直”</strong>
形式（即按列展开）将受到 Kronecker积的影响。)</td>
</tr>
</tbody>
</table>
<h3 id="矩阵分布">1.4.1 矩阵分布</h3>
<p>设 <span class="math inline">\(X_1, \cdots, X_n\)</span>
i.i.d.(独立同分布, independent and identically distributed)，<span
class="math inline">\(X_i = (x_{i1}, \cdots, x_{ip})&#39;
\stackrel{d}{=} N_p(\mu, \Sigma)\)</span>，即 <span
class="math inline">\(X_1, \cdots, X_n\)</span> 是来自 <span
class="math inline">\(p\)</span> 元正态总体 <span
class="math inline">\(N_p(\mu, \Sigma)\)</span> 的独立样本。</p>
<p>记 <span class="math inline">\(X=(X_1, \cdots, X_n)\)</span>，则
<span class="math inline">\(X\)</span> 是一个 <span
class="math inline">\(p\times n\)</span> 的随机矩阵。</p>
<p>随机矩阵的期望：<span class="math inline">\(E(X)=(\mu, \cdots,
\mu)=\mu\cdot 1_n&#39;\)</span>， 其中 <span
class="math inline">\(1_n=(1, \cdots, 1)&#39;\)</span>。</p>
<p>矩阵的拉直运算：<span
class="math inline">\(\text{vec}(X)=\text{vec}((X_1, \cdots, X_n))
=  \begin{pmatrix} X_1\\ \vdots\\ X_n \end{pmatrix}_{(np)\times
1}\)</span></p>
<p>随机矩阵的协方差阵：<span
class="math inline">\(Cov(X)=Cov(vec(X))\)</span></p>
<p><strong>随机矩阵的分布：随机矩阵拉直后的随机向量的分布。</strong></p>
<p>矩阵<span class="math inline">\(X\)</span>的运算 由于<span
class="math inline">\(X=(X_1,\cdots,X_n)\)</span>，有 <span
class="math display">\[
E(\text{vec}(X)) =  \begin{pmatrix} \mu\\ \vdots\\ \mu \end{pmatrix},
\quad \text{Cov}(\text{vec}(X)) =  \begin{pmatrix} \Sigma &amp; 0 &amp;
\cdots &amp; 0\\ 0 &amp; \Sigma &amp; \cdots &amp; 0\\ \vdots &amp;
\vdots &amp; \ddots &amp; \vdots\\ 0 &amp; 0 &amp; \cdots &amp; \Sigma
\end{pmatrix}
\]</span> 即<span class="math inline">\(E(\text{vec}(X)) = 1_n \otimes
\mu\)</span>，<span class="math inline">\(\text{Cov}(\text{vec}(X)) =
I_n \otimes \Sigma\)</span>，其中<span
class="math inline">\(I_n\)</span>是<span
class="math inline">\(n\)</span>阶单位阵。</p>
<blockquote>
<p>是因为<span class="math inline">\(X_1, \cdots, X_n\)</span>
独立同分布，所以它们的<span
class="math inline">\(\mu,\Sigma\)</span>都是一样的。</p>
</blockquote>
<h4 id="随机矩阵拉直运算的性质转置">随机矩阵拉直运算的性质(转置)</h4>
<p>性质1：对 <span class="math inline">\(n\times m\)</span> 的随机矩阵
<span class="math inline">\(Y\)</span>，若有 <span
class="math display">\[
E(\text{vec}(Y))=\alpha\otimes\beta, \text{Cov}(\text{vec}(Y)) =
A\otimes B
\]</span> 其中，<span class="math inline">\(\alpha,\beta\)</span> 分别是
<span class="math inline">\(m\)</span> 和 <span
class="math inline">\(n\)</span> 维列向量，<span
class="math inline">\(A\)</span> 和 <span
class="math inline">\(B\)</span> 分别是 <span
class="math inline">\(m\)</span> 和 <span
class="math inline">\(n\)</span> 阶方阵，则 <span
class="math display">\[
E(\text{vec}(Y&#39;))=\beta\otimes\alpha, \text{Cov}(\text{vec}(Y&#39;))
= B\otimes A
\]</span></p>
<p>由性质1，对上述随机矩阵 <span class="math inline">\(X\)</span> 有
<span class="math display">\[
E(\text{vec}(X&#39;))=\mu\otimes 1_n,
\text{Cov}(\text{vec}(X&#39;))=\Sigma\otimes I_n
\]</span> 因此，对由 <span class="math inline">\(n\)</span> 个 <span
class="math inline">\(p\)</span> 维正态总体的独立样本组成的随机矩阵
<span class="math inline">\(X\)</span>， <span
class="math inline">\(\text{vec}(X)\stackrel{d}{\sim}N_{np}(1_n\otimes\mu,
I_n\otimes\Sigma)\)</span>， <span
class="math inline">\(\text{vec}(X&#39;)\stackrel{d}{\sim}N_{np}(\mu\otimes
1_n,\Sigma\otimes I_n)\)</span>。</p>
<h3 id="矩阵正态分布">1.4.3 矩阵正态分布</h3>
<blockquote>
<p>矩阵正态分布是指矩阵的每一列或每一行都服从正态分布，且这些列或行之间可能具有某种协方差结构。</p>
<p><strong>矩阵正态分布的一个重要特性是它的“拉直”形式也是正态分布。</strong></p>
</blockquote>
<p>假设矩阵 <span class="math inline">\(X\)</span> 是一个 <span
class="math inline">\(n \times p\)</span>
的矩阵，它的“拉直”（vectorization）形式 <span
class="math inline">\(\text{vec}(X)\)</span>
也就是把矩阵按列展开成一个向量。如果这个向量服从正态分布，我们就说矩阵
<span class="math inline">\(X\)</span> 服从
<strong>矩阵正态分布</strong>。更具体地：</p>
<ul>
<li>如果 <span
class="math inline">\(\text{vec}(X)\stackrel{d}{\sim}N_{np}(1_n\otimes\mu,
I_n\otimes\Sigma)\)</span>，我们说矩阵 <span
class="math inline">\(X\)</span> 服从矩阵正态分布，记为：<span
class="math inline">\(X\stackrel{d}{\sim}N_{p\times n}(\mu\cdot
1_n&#39;,I_n\otimes\Sigma)\)</span>。</li>
</ul>
<p>一般地，记 <span class="math inline">\(n\times p\)</span>
的正态随机矩阵为 <span
class="math inline">\(X\stackrel{d}{\sim}N_{n\times p}(B,\Sigma\otimes
V)\)</span>，其中 <span class="math display">\[
\begin{cases}
B= E(X)=\mu\cdot 1_n&#39;\\
\Sigma\otimes V=\text{Cov}(\text{vec}(X))=I_n\otimes\Sigma
\end{cases}
\]</span> <span class="math inline">\(\Sigma\)</span> 和 <span
class="math inline">\(V\)</span> 分别是 <span
class="math inline">\(p\)</span> 和 <span
class="math inline">\(n\)</span> 阶方阵(正定阵)，分别控制着<span
class="math inline">\(X\)</span>的行列之间的协方差结构。</p>
<p>从这个分布，可以得到<span
class="math inline">\(X\)</span>的拉直形式<span
class="math inline">\(vec(X)\)</span>服从以下正态分布： <span
class="math display">\[
\text{vec}(X)\stackrel{d}{\sim}N_{np}(\text{vec}(B),\Sigma\otimes V)
\]</span></p>
<h4 id="密度函数">密度函数</h4>
<p>矩阵正态分布的密度函数表示了矩阵 <span
class="math inline">\(X\)</span> 出现某种特定值的概率。</p>
<p>若 <span class="math inline">\(X\stackrel{d}{\sim}N_{p\times n}(B,
V\otimes\Sigma)\)</span>，其密度函数如下： <span class="math display">\[
\frac{1}{(2\pi)^{(np)/2}|V\otimes\Sigma|^{1/2}}\exp\left\{-\frac{1}{2}(\text{vec}(X
- B))&#39;(V\otimes\Sigma)^{-1}(\text{vec}(X - B))\right\}
\]</span> 上式等价于（用<strong>迹的性质</strong>进行简化）： <span
class="math display">\[
\frac{1}{(2\pi)^{(np)/2}|V|^{n/2}|\Sigma|^{p/2}}\exp\left\{-\frac{1}{2}\text{tr}[(X
- B)&#39;\Sigma^{-1}(X - B)V^{-1}]\right\}
\]</span> <strong>证明：</strong>(即证<span
class="math inline">\((\text{vec}(X) - \text{vec}(B))&#39; (V \otimes
\Sigma)^{-1} (\text{vec}(X) - \text{vec}(B)) = \text{tr} \left[ (X -
B)&#39; \Sigma^{-1} (X - B) V^{-1} \right]\)</span>)</p>
<blockquote>
<p>利用Kronecker积的一个重要性质：<span
class="math inline">\(\text{vec}(AXB)=(B&#39;\otimes
A)\text{vec}(X)\)</span> 其中 <span
class="math inline">\(A\)</span>、<span class="math inline">\(X\)</span>
和 <span class="math inline">\(B\)</span> 分别是 <span
class="math inline">\(n\times p\)</span>、<span
class="math inline">\(p\times q\)</span> 和 <span
class="math inline">\(q\times m\)</span> 的矩阵。 <span
class="math display">\[
\begin{align}
右式&amp;=\text{tr} \left[ (X - B)&#39; \Sigma^{-1} (X - B) V^{-1}
\right]\\
&amp;\overset{性质7}{=}\left(vec(X-B)\right)&#39;\left(vec(\Sigma^{-1}
(X - B) V^{-1})\right)\\
&amp;\overset{性质9}{=}\left(vec(X-B)\right)&#39;(\Sigma^{-1}\otimes
V^{-1})vec(X-B)\\
&amp;\overset{性质6}{=}\left(vec(X-B)\right)&#39;(\Sigma\otimes
V)^{-1}vec(X-B)\\
&amp;=左式
\end{align}
\]</span></p>
</blockquote>
<h4 id="线性变换">线性变换</h4>
<blockquote>
<p>如果矩阵服从正态分布，经过线性变换后，结果仍然服从矩阵正态分布，只是均值和协方差矩阵发生了变化。</p>
</blockquote>
<p>性质2：设 <span class="math inline">\(p\times n\)</span> 的矩阵 <span
class="math inline">\(X\)</span> 服从矩阵正态分布 <span
class="math inline">\(X\stackrel{d}{\sim}N_{p\times n}(B,
V\otimes\Sigma),(\Sigma_{p\times p}\geq0, V_{n\times
n}\geq0)\)</span>。</p>
<p>对其进行线性变换$ Y = C + AX,$ 其中 <span
class="math inline">\(C_{q\times m}, A_{q\times p}\)</span> 和 <span
class="math inline">\(\Gamma_{n\times m}\)</span> 是常数矩阵。</p>
<p>则矩阵<span class="math inline">\(Y\)</span>的分布将是： <span
class="math display">\[
Y\stackrel{d}{\sim}N_{q\times m}((C + AB\Gamma),
(\Gamma&#39;V\Gamma)\otimes (A\Sigma A&#39;))
\]</span> <span class="math inline">\(C+AB\Gamma\)</span>：这是矩阵
<span class="math inline">\(Y\)</span>
的均值矩阵，表示了经过线性变换后的期望。</p>
<p><span class="math inline">\((\Gamma&#39; V \Gamma) \otimes (A \Sigma
A&#39;)\)</span>：这是矩阵 <span class="math inline">\(Y\)</span>
的协方差矩阵，表示了变换后的行列协方差结构。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/wtf/" rel="tag"># wtf</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/11/23/%E7%9C%8B%E7%9C%8B%E4%BD%A0%E7%9A%84Bins/" rel="prev" title="heap bins">
      <i class="fa fa-chevron-left"></i> heap bins
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/11/26/kernel%20rop/" rel="next" title="kernel rop">
      kernel rop <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ch1-%E5%A4%9A%E5%85%83%E5%88%86%E5%B8%83"><span class="nav-number">1.</span> <span class="nav-text">Ch1 多元分布</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86"><span class="nav-number">1.1.</span> <span class="nav-text">1.0 预备知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8Fx"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.0.1 随机变量\(X\)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E5%90%91%E9%87%8Fxx_1x_2dotsx_p"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.0.2 随机向量\(X&#x3D;(X_1,X_2,\dots,X_p)&#39;\)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%85%83%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E9%9A%8F%E6%9C%BA%E5%90%91%E9%87%8F"><span class="nav-number">1.1.3.</span> <span class="nav-text">1.0.3 多元随机变量(随机向量)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E7%9F%A5%E8%AF%86"><span class="nav-number">1.1.4.</span> <span class="nav-text">1.0.4 矩阵知识</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%85%83%E7%89%B9%E5%BE%81%E5%87%BD%E6%95%B0"><span class="nav-number">1.1.5.</span> <span class="nav-text">1.0.5 多元特征函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E5%85%83%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83"><span class="nav-number">1.2.</span> <span class="nav-text">1.1 一元正态分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E5%85%83%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83"><span class="nav-number">1.3.</span> <span class="nav-text">1.2 多元正态分布</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%A7%E8%B4%A8"><span class="nav-number">1.3.1.</span> <span class="nav-text">1.2.2 性质</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0"><span class="nav-number">1.4.</span> <span class="nav-text">1.3 相关系数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%83%E4%B9%A0"><span class="nav-number">1.4.1.</span> <span class="nav-text">1.3.1 练习</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E5%A4%9A%E5%85%83%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83"><span class="nav-number">1.5.</span> <span class="nav-text">1.4 矩阵多元正态分布</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E6%8B%89%E7%9B%B4%E5%92%8Ckronecker%E7%A7%AF"><span class="nav-number">1.5.1.</span> <span class="nav-text">1.4.0 矩阵拉直和Kronecker积</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E5%88%86%E5%B8%83"><span class="nav-number">1.5.2.</span> <span class="nav-text">1.4.1 矩阵分布</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E7%9F%A9%E9%98%B5%E6%8B%89%E7%9B%B4%E8%BF%90%E7%AE%97%E7%9A%84%E6%80%A7%E8%B4%A8%E8%BD%AC%E7%BD%AE"><span class="nav-number">1.5.2.1.</span> <span class="nav-text">随机矩阵拉直运算的性质(转置)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83"><span class="nav-number">1.5.3.</span> <span class="nav-text">1.4.3 矩阵正态分布</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%86%E5%BA%A6%E5%87%BD%E6%95%B0"><span class="nav-number">1.5.3.1.</span> <span class="nav-text">密度函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2"><span class="nav-number">1.5.3.2.</span> <span class="nav-text">线性变换</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="dustball"
      src="https://raw.githubusercontent.com/DeutschBall/picbed/main/dustball.png">
  <p class="site-author-name" itemprop="name">dustball</p>
  <div class="site-description" itemprop="description">dustland</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">dustball</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  
  <script data-pjax>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="/js/algolia-search.js"></script>












<script data-pjax>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'dark',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


    <div id="pjax">
  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

    </div>
</body>
</html>
